/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    nf-core/moleculardocking Nextflow AWS Batch config file
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Configuration for running on AWS Batch
----------------------------------------------------------------------------------------
*/

// AWS Batch executor settings
process {
    executor = 'awsbatch'

    // Default compute environment queue - adjust to your setup
    queue = 'default'

    // Module-specific resource allocations for docking
    withName: 'RECEPTOR_PREP' {
        cpus   = 1
        memory = 4.GB
    }

    withName: 'LIGAND_PREP' {
        cpus   = 1
        memory = 4.GB
    }

    withName: 'MOLECULARDOCKING_DOCK' {
        cpus   = 8
        memory = 16.GB
    }

    withName: 'MOLECULARDOCKING_PARSE' {
        cpus   = 1
        memory = 2.GB
    }

    withName: 'SCORE_AGGREGATE' {
        cpus   = 1
        memory = 4.GB
    }

    withName: 'MULTIQC' {
        cpus   = 2
        memory = 4.GB
    }
}

// AWS settings
aws {
    batch {
        // The AWS CLI tool is required in the PATH to authenticate and submit jobs
        cliPath = '/home/ec2-user/miniconda/bin/aws'
        // Maximum number of parallel job submissions
        maxParallelTransfers = 10
        // Maximum number of retries for failed API calls
        maxTransferAttempts = 3
    }
    region = 'us-east-1'  // Adjust to your AWS region
}

// Docker settings for AWS Batch
docker {
    enabled = true
}

// Executor settings
executor {
    name      = 'awsbatch'
    queueSize = 200
}

// Use S3 for work directory (required for AWS Batch)
// Set workDir in your command: nextflow run ... -work-dir s3://your-bucket/work
