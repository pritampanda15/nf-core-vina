/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    nf-core/vina Nextflow SLURM config file
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Configuration for running on HPC clusters with SLURM scheduler
----------------------------------------------------------------------------------------
*/

process {
    executor = 'slurm'

    // Default queue/partition - adjust to your cluster
    queue = { task.memory >= 100.GB ? 'highmem' : 'standard' }

    // Cluster options - adjust to your SLURM configuration
    clusterOptions = { "--account=your_account" }

    // Module-specific resource allocations for docking
    withName: 'RECEPTOR_PREP' {
        cpus   = 1
        memory = 4.GB
        time   = 1.h
    }

    withName: 'LIGAND_PREP' {
        cpus   = 1
        memory = 4.GB
        time   = 1.h
    }

    withName: 'VINA_DOCK' {
        cpus   = { 8 * task.attempt }
        memory = { 16.GB * task.attempt }
        time   = { 4.h * task.attempt }
    }

    withName: 'VINA_PARSE' {
        cpus   = 1
        memory = 2.GB
        time   = 30.m
    }

    withName: 'SCORE_AGGREGATE' {
        cpus   = 1
        memory = 4.GB
        time   = 30.m
    }

    withName: 'MULTIQC' {
        cpus   = 2
        memory = 4.GB
        time   = 1.h
    }
}

// Singularity settings for HPC
singularity {
    enabled    = true
    autoMounts = true
    cacheDir   = "${HOME}/.singularity/cache"
}

// Executor settings
executor {
    name            = 'slurm'
    queueSize       = 100
    submitRateLimit = '10 sec'
    exitReadTimeout = '5 min'
}
